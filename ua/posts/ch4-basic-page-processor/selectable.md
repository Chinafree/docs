## 4.2 Вибір ланцюга API

Мережа API `Selectable` актуальним є основною функцією WebMagic. Можливість вибору інтерфейсу для використання, ви можете завершити ланцюжок вилучення безпосередньо до елементів сторінки, і потрібно подбати про деталі відкликані.

Можна побачити в попередньому прикладі, page.getHtml () повертає об'єкт `Html`, який реалізує інтерфейс` Selectable`. Цей інтерфейс містить ряд важливих способів, я розділити його на дві категорії: часткове розтин екстракції і отримати результати.

#### Extraction розділ 4.2.1 API:

| метод | опис | приклади |
| ------------ | ------------- | ------------ |
| XPath (String XPath) | Використання XPath селектор | html.xpath ( "// DIV [@ клас = 'назва']") |
| $ (Селектор String) | Використовуйте селектор CSS, щоб вибрати | HTML $ ( "div.title"). |
| $ (String селектор, String атр) | Використовуйте селектор CSS, щоб вибрати | HTML $ ( "div.title", "текст"). |
| CSS (селектор String) | Функція з $ (), використовуючи селектор CSS, щоб вибрати | html.css ( "div.title") |
| посилання () | Вибрати всі посилання | html.links () |
| регулярний вираз (String регулярний вираз) | Використовуйте регулярні вирази для вилучення | html.regex ( "\ <DIV \> (\ *) \ </ DIV>.?") |
| регулярний вираз (String регулярний вираз, Int група) | Використовуйте регулярні вирази для вилучення і вказати групу захоплення | html.regex ( "\ <DIV \> (\ *) \ </ DIV>.?", 1) |
| замінити (String регулярний вираз, рядок заміни) | Замінити вміст | html.replace ( ". \ <сценарій> \ * \ </ скрипт>", "") |

Ця частина витягується API повертає ключ `інтерфейси Selectable`, а це означає, що витяг підтримується прикутих викликів. Дозвольте мені використовувати приклад, щоб пояснити використання ланцюга API.

Наприклад, зараз я хочу, щоб захопити всі проекти Java на GitHub, ці елементи можуть бути [https://github.com/search?l=Java&p=1&q=stars%3A%3E1&s=stars&type=Repositories](https:// github.com/search?l=Java&p=1&q=stars%3A%3E1&s=stars&type=Repositories) побачити результати пошуку.

Щоб уникнути сканування занадто широкий, я вказати обмеження перевірки посилання з секції закладок. Правила обходу контенту є більш складними, я б, як писати?

! [За вибором ланцюгової Ui] (http://webmagic.qiniudn.com/oscimages/151454_2T01_190591.png)

По-перше, дивіться стор HTML структура виглядає наступним чином:

! [Можливі-ланцюг] (http://webmagic.qiniudn.com/oscimages/151632_88Oq_190591.png)

Тоді я можу використовувати CSS селектори, щоб витягти цей DIV, а потім взяти всі посилання. Для цілей страхування, я буду використовувати регулярні вирази, щоб визначити, що формат витягнутої URL, а потім остаточне формулювання виглядає так:

`` `Java
List <String> URLs = page.getHtml () CSS ( "div.pagination") посилання () регулярний вираз ( "* / пошук / \ л = Java *.?.") Всі () ....;
`` `

Тоді ми можемо поставити ці URL доданий до списку для сканування:

`` `Java
List <String> URLs = page.getHtml () CSS ( "div.pagination") посилання () регулярний вираз ( "* / пошук / \ л = Java *.?.") Всі () ....;
page.addTargetRequests (URLs);
`` `

Це не просто? На додаток до пошуку по посиланню, ланцюги звертається за вибором також може зробити багато роботи. У розділі 9 ми знову вище приклади.

#### 4.2.2 отримати результати API:

Коли ланцюг виклику, ми звичайно хочемо отримати тип рядка результату. На цей раз ми повинні використовувати API для отримання результатів. Ми знаємо, що правила вилучення, або XPath, CSS селектори або регулярний вираз, завжди можна витягти безліч елементів. WebMagic вони були об'єднані, ви можете отримати один або кілька елементів за допомогою різних API.

| метод | опис | приклади |
| ------------ | ------------- | ------------ |
| отримуємо () | повертає результат типу String, | Рядок посилання = html.links () отримуємо (). |
| ToString () | функція Get (), повертає результат типу String, | Рядок посилання = html.links () ToString (). |
| всі () | повертає всі результати вилучення | List <String> посилання = html.links () все (). |
| матч () | є результат матчу | якщо (html.links () матч ().) {ххх; } |

Наприклад, ми знаємо, що сторінка буде мати результат, ви можете використовувати selectable.get () або selectable.toString (), щоб отримати цей результат.

Тут selectable.toString () використовує ToString () цей інтерфейс, а також для виробництва і рамок в поєднанні, більш зручними. Тому що при нормальних обставинах, нам потрібно тільки вибрати один елемент!

selectable.all () отримає до всіх елементів.

Ну, до сих пір, озирнутися назад на 3.1 GithubRepoPageProcessor, ви можете відчувати себе більш ясно, чи не так? Визначає основний метод, результати вже можна побачити плазує в консолі виводу.
